(this["webpackJsonpoutcubator-test"]=this["webpackJsonpoutcubator-test"]||[]).push([[0],{666:function(e,t,r){},667:function(e,t,r){"use strict";r.r(t);r(161),r(217),r(127),r(175),r(108),r(176),r(321),r(370),r(547);var n=r(0),a=r(25),c=r.n(a),s=r(120),i=r.n(s),u=r(197),o=r(42),d=r(39),l=r(22),b=r(23),j=r(121),m=r(293),h=r(294),p=r(117),O=r(295),f=r.n(O);function x(e){return e&&"object"===typeof e&&!Array.isArray(e)}function v(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(!r.length)return e;var a=r.shift();if(x(e)&&x(a))for(var c in a)x(a[c])?(e[c]||Object.assign(e,Object(p.a)({},c,{})),v(e[c],a[c])):Object.assign(e,Object(p.a)({},c,a[c]));return v.apply(void 0,[e].concat(r))}var y=function(e,t){if(!e)return null;if(!x(t))return null;var r=new URL(e);return Object.keys(t).forEach((function(e){return r.searchParams.append(e,t[e])})),r},g=Object(m.a)("instance"),N=function(){function e(){Object(l.a)(this,e),this.defaultOptions={headers:{Accept:"application/json"}},this.isStatusSuccess=function(e){return e>=200&&e<300}}return Object(b.a)(e,[{key:"request",value:function(e){var t=this,r=e.url,n=e.options;return new Promise((function(e,a){if(!r)return t.handleError(a,"Error! No url was provided.");var c=v(Object(d.a)({},t.defaultOptions),n);(t.isFetchApiAvailable()?fetch:h.a)(r,c).then((function(e){return t.handleRequestSuccess(e,e.status)})).then((function(e){return e.json()})).then((function(r){return t.handleSuccess(e,r,r.status)})).catch((function(e){return t.handleError(a,e)}))}))}},{key:"handleRequestSuccess",value:function(e,t){if(this.isStatusSuccess(t))return e;throw e}},{key:"handleSuccess",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200;return e({data:t,status:r})}},{key:"handleError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:500,n=t.response||t,a=n.type,c=void 0===a?"error":a,s=n.message,i=void 0===s?"Internal Server Error":s,u=n.status,o=void 0===u?r:u,l=n.data,b=void 0===l?null:l,j=t.response||t,m=j.reason,h=void 0===m?"Request failed":m,p=j.name,O=void 0===p?"Request failed":p,f=Object(d.a)(Object(d.a)({},b),{},{status:o});"SyntaxError"===O&&(f={name:O,reason:h="The response returned from the endpoint was probably not valid JSON"}),"FetchError"!==O&&"system"!==t.type||("request-timeout"===c?(h="Timed out in the call.",O="Timeout"):h="Failed to connect to the endpoint. This is likely connectivity issues with the endpoint",f={name:O,reason:h,type:c,message:i}),e({status:o,error:f})}},{key:"isFetchApiAvailable",value:function(){return"fetch"in window}},{key:"get",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=y(e,t);return this.request({url:n,options:{method:"GET",headers:r}})}}],[{key:"getInstance",value:function(){return Object(j.a)(e,g)[g]||(Object(j.a)(e,g)[g]=new e,Object(j.a)(e,g)[g].constructor=null),Object(j.a)(e,g)[g]}}]),e}();Object.defineProperty(N,g,{writable:!0,value:null});var w=N.getInstance(),k=function(){return w.get("https://ipinfo.io",{},{Authorization:"Bearer 9236c16abaedb2"})},E=function(e){var t={sign_version:2,key:"c5fb24b34ae994141a0ecd83b09e7e68",country_code:e},r=function(e,t){if(!x(e))return null;var r=Object.keys(e).sort().reduce((function(t,r){if(e.hasOwnProperty(r))return t[r]=e[r],t}),{}),n=Object.entries(r).reduce((function(e,t){return e+(t[0]+"=")+t[1]}),"");return n+=t,f()(n)}(t,"25246a1d4b1e01eff875ef68ec7cdd68");if(r)return w.get("/proxy.php?url=".concat(encodeURI("https://api.paymentwall.com/api/payment-systems/")),Object(d.a)(Object(d.a)({},t),{},{sign:r}))},C=r(716),S=r(717),q=r(712),D=r(32),I=r(72),P=r(714),A=r(95);var V=[/\d/,/\d/,"/",/\d/,/\d/],F=[/\d/,/\d/,/\d/,/\d/," ",/\d/,/\d/,/\d/,/\d/," ",/\d/,/\d/,/\d/,/\d/," ",/\d/,/\d/,/\d/,/\d/," "],R=r(719),U=r(713),W=r(722),T=r(718),B=r(305),J=r.n(B),L=r(709),M=r(721),_=r(4),z=function(e){var t=e.onUpdate,r=e.selected,a=Object(n.useState)(r),c=Object(o.a)(a,2),s=c[0],i=c[1],u=Object(n.useMemo)((function(){return J()().getData()}),[]);return Object(_.jsxs)(L.a,{fullWidth:!0,children:[Object(_.jsx)(M.a,{children:"Choose country"}),Object(_.jsx)(T.a,{value:s,onChange:function(e){i(e.target.value),t(e.target.value)},children:u.map((function(e){return Object(_.jsx)(W.a,{value:e.value,children:e.label},e.value)}))})]})};z.defaultProps={onUpdate:function(){return{}},selected:""};var G=z,Y=r(704),Z=r(710),$=r(308),H=r(306),K=r.n(H),Q=function(e){var t=e.inputRef,r=e.mask,n=e.name,a=Object($.a)(e,["inputRef","mask","name"]);return Object(_.jsx)(K.a,Object(d.a)(Object(d.a)({},a),{},{name:n,ref:function(e){t(e?e.inputElement:null)},mask:r,showMask:!0}))};Q.defaultProps={inputRef:null,mask:[],name:""};var X=Q,ee=function(e){var t=e.field,r=e.form,n=r.touched,a=r.errors;return Object(_.jsxs)("div",{children:[Object(_.jsx)(M.a,{error:a.cardNumber&&n.cardNumber,shrink:!0,htmlFor:"cardNumberInput",children:"Card number"}),Object(_.jsx)(Y.a,Object(d.a)(Object(d.a)({},t),{},{error:a.cardNumber&&n.cardNumber,inputProps:{id:"cardNumberInput",mask:F,name:t.name,placeholderChar:"\u2000"},inputComponent:X})),a.cardNumber&&n.cardNumber&&Object(_.jsx)(D.a,{name:"cardNumber",render:function(e){return Object(_.jsx)(Z.a,{error:!0,children:e})}})]})},te=function(e){var t=e.field,r=e.form,n=r.touched,a=r.errors;return Object(_.jsxs)("div",{children:[Object(_.jsx)(M.a,{error:a.cardExpDate&&n.cardExpDate,shrink:!0,htmlFor:"cardExpDateInput",children:"Card exp. date"}),Object(_.jsx)(Y.a,Object(d.a)(Object(d.a)({},t),{},{error:a.cardExpDate&&n.cardExpDate,inputProps:{id:"cardExpDateInput",mask:V,name:t.name},mask:V,inputComponent:X})),a.cardExpDate&&n.cardExpDate&&Object(_.jsx)(D.a,{name:"cardExpDate",render:function(e){return Object(_.jsx)(Z.a,{error:!0,children:e})}})]})},re=I.a({cardholderName:I.b().matches(/^[aA-zZ\s]+$/,"Only alphabets are allowed for this field ").required("Cardholder name is required"),cardNumber:I.b().transform((function(e,t){return e.replace(/\s/g,"")})).required("Card number is required").test("luhn-test","Invalid card number",(function(e){return function(e){if(!e)return!1;for(var t=0,r=!1,n=(e=String(e)).length-1;n>=0;n--){var a=e.charAt(n),c=parseInt(a,10);r&&(c*=2)>9&&(c-=9),t+=c,r=!r}return t%10===0}(e)})),cardExpDate:I.b().test("month-test","Invalid month",(function(e){return function(e){if(!e)return!1;var t=e.split("/"),r=Object(o.a)(t,1)[0];return!(Number(r)>12)}(e)})).test("past-date-test","Exp.date can't be earlier than today",(function(e){return function(e){if(!e)return!1;var t=new Date,r=t.getMonth()+1,n=t.getFullYear().toString().substr(-2),a=e.split("/"),c=Object(o.a)(a,2),s=c[0],i=c[1];return!(Number(i)<Number(n))&&!(Number(s)<r&&Number(i)<=Number(n))}(e)})).required("Card exp. date is required"),cardCVV:I.b().required("CVV code is required").min(3).max(3),amount:I.b().required("Amount is required"),currency:I.b().required("Currency is required")}),ne=function(e){var t,r=e.userCountry,n=e.setUserCountry,a=e.paymentSystems,c=e.currencies;return Object(_.jsx)(D.d,{initialValues:{cardholderName:"",cardNumber:"",amount:"5",cardExpDate:"",cardCVV:"",currency:"USD",paymentSystem:null===(t=a[0])||void 0===t?void 0:t.id},validateOnBlur:!0,validateOnChange:!0,validationSchema:re,onSubmit:function(e,t){var r=t.setSubmitting;alert(JSON.stringify(e,null,2)),r(!1)},children:function(e){var t=e.values,s=e.handleChange,i=(e.handleBlur,e.submitForm,e.isSubmitting,e.touched),u=e.errors;return Object(_.jsxs)(D.c,{children:[Object(_.jsxs)("div",{className:"form-content",children:[Object(_.jsxs)(U.a,{container:!0,spacing:3,children:[Object(_.jsx)(U.a,{item:!0,xs:12,sm:6,children:Object(_.jsx)("div",{className:"widget-country-block",children:r&&Object(_.jsx)(G,{selected:r,onUpdate:function(e){n(e)}})})}),Object(_.jsx)(U.a,{item:!0,xs:12,sm:6,children:Object(_.jsx)("div",{className:"widget-payment-systems-block",children:Object(_.jsx)(D.b,{fullWidth:!0,label:"Choose payment system",component:A.a,type:"text",name:"paymentSystem",select:!0,InputLabelProps:{shrink:!0},children:a.length>0?a.map((function(e){return Object(_.jsxs)(W.a,{value:e.id,className:"select-system-menu-item",children:[Object(_.jsx)("img",{src:e.img_url,alt:"".concat(e.name)}),Object(_.jsx)(q.a,{children:e.name})]},e.id)})):Object(_.jsx)(q.a,{children:"No options provided"})})})}),Object(_.jsx)(U.a,{item:!0,xs:12,children:Object(_.jsxs)("div",{className:"widget-amount-block",children:[Object(_.jsx)(q.a,{children:"Enter amount:"}),Object(_.jsxs)("div",{className:"widget-amount-fields",children:[Object(_.jsx)(D.b,{inputProps:{className:"text-center"},component:A.a,type:"number",id:"amount",name:"amount",color:"primary"}),Object(_.jsx)(D.b,{component:A.a,type:"text",name:"currency",select:!0,InputLabelProps:{shrink:!0},children:c.map((function(e){return Object(_.jsx)(W.a,{value:e,children:e},e)}))})]})]})}),Object(_.jsx)(U.a,{item:!0,xs:12,sm:6,children:Object(_.jsx)(D.b,{fullWidth:!0,component:A.a,type:"text",id:"cardholderName",label:"Cardholder name",name:"cardholderName"})}),Object(_.jsx)(U.a,{item:!0,xs:12,sm:6,children:Object(_.jsx)(D.b,{fullWidth:!0,type:"number",id:"cardNumber",label:"Card number",name:"cardNumber",component:ee})}),Object(_.jsx)(U.a,{item:!0,xs:6,children:Object(_.jsx)(D.b,{fullWidth:!0,type:"number",id:"cardExpDate",name:"cardExpDate",component:te})}),Object(_.jsx)(U.a,{item:!0,xs:6,children:Object(_.jsx)(D.b,{component:A.a,type:"password",id:"cardCVV",label:"CVV",name:"cardCVV",onChange:function(e){var t=e.target.value;t.length>3&&(t=t.slice(0,3)),e.target.value=t,s(e)}})})]}),0===Object.keys(u).length&&Object.keys(i).length>0&&Object(_.jsx)(R.a,{variant:"outlined",severity:"success",className:"alert-message",children:"All fields were filled correctly!"})]}),Object(_.jsx)(P.a,{disabled:Object.keys(u).length>0||"0"===t.amount,color:"primary",variant:"contained",fullWidth:!0,type:"submit",children:"Pay ".concat(t.amount||0," ").concat(t.currency)})]})}})},ae=r(715),ce=function(){return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("div",{className:"form-content skeleton",children:Object(_.jsxs)(U.a,{container:!0,spacing:3,children:[Object(_.jsx)(U.a,{item:!0,xs:12,sm:6,children:Object(_.jsx)(ae.a,{variant:"rect",animation:"wave",height:48})}),Object(_.jsx)(U.a,{item:!0,xs:12,sm:6,children:Object(_.jsx)(ae.a,{variant:"rect",animation:"wave",height:48})}),Object(_.jsx)(U.a,{item:!0,xs:12,children:Object(_.jsx)(ae.a,{variant:"rect",animation:"wave",height:65})}),Object(_.jsx)(U.a,{item:!0,xs:12,sm:6,children:Object(_.jsx)(ae.a,{variant:"rect",animation:"wave",height:48})}),Object(_.jsx)(U.a,{item:!0,xs:12,sm:6,children:Object(_.jsx)(ae.a,{variant:"rect",animation:"wave",height:48})}),Object(_.jsx)(U.a,{item:!0,xs:6,children:Object(_.jsx)(ae.a,{variant:"rect",animation:"wave",height:48})}),Object(_.jsx)(U.a,{item:!0,xs:6,children:Object(_.jsx)(ae.a,{variant:"rect",animation:"wave",height:48})})]})}),Object(_.jsx)(ae.a,{variant:"rect",animation:"wave",height:48})]})},se=r(307),ie=r.n(se);var ue=function(){var e=Object(n.useState)(!1),t=Object(o.a)(e,2),r=t[0],a=t[1],c=Object(n.useState)(null),s=Object(o.a)(c,2),d=s[0],l=s[1],b=Object(n.useState)([]),j=Object(o.a)(b,2),m=j[0],h=j[1];return Object(n.useEffect)((function(){function e(){return(e=Object(u.a)(i.a.mark((function e(){var t,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(!0),e.prev=1,e.next=4,k();case 4:200===(t=e.sent).status&&(r=t.data.country,l(r)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0.error);case 11:a(!1);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(n.useEffect)((function(){function e(){return(e=Object(u.a)(i.a.mark((function e(){var t,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!d){e.next=13;break}return a(!0),e.prev=2,e.next=5,E(d);case 5:200===(t=e.sent).status&&(r=t.data,h(r)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0.error);case 12:a(!1);case 13:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[d]),Object(_.jsxs)("div",{className:"app",children:[Object(_.jsx)("header",{className:"app-header",children:"Payment widget"}),Object(_.jsx)("main",{className:"app-content",children:Object(_.jsxs)(C.a,{className:"widget-container",children:[Object(_.jsx)("div",{className:"widget-loader-block",children:r&&Object(_.jsx)(S.a,{})}),Object(_.jsxs)("div",{className:"widget",children:[Object(_.jsx)(q.a,{align:"center",variant:"h5",color:"primary",className:"widget-title",children:"Payment widget"}),r?Object(_.jsx)(ce,{}):Object(_.jsx)(ne,{currencies:ie.a.codes(),userCountry:d,setUserCountry:l,paymentSystems:m})]})]})})]})};r(666);c.a.render(Object(_.jsx)(ue,{}),document.getElementById("root"))}},[[667,1,2]]]);
//# sourceMappingURL=main.c1c808a8.chunk.js.map